<!DOCTYPE html>
<html>
<head>
	<title>绑定支付方式</title>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="__PUBLIC__/Home/js/rem.js"></script>
    <!-- <script src="js/mui.min.js"></script> -->
    <link rel="stylesheet" href="__PUBLIC__/Home/css/reset.css" />
    <link href="__PUBLIC__/Home/css/mui.css" rel="stylesheet"/>
    <link rel="stylesheet" href="__PUBLIC__/Home/css/main.css" />
    <link rel="stylesheet" href="__PUBLIC__/Home/iconfont/iconfont.css" />
    <script type="text/javascript" src="__PUBLIC__/Home/js/jquery-3.3.1.js"></script>
    <script src="__PUBLIC__/Home/js/highcharts.js"></script>
    <script src="__PUBLIC__/layer/layer.js"></script>
    <script src="__PUBLIC__/Home/js/main.js"></script>
<body class="gray-body">
    <header class="common-header">
        <a href="javaScript:history.go(-1)" class="back">
            <i class="iconfont">&#xe60f;</i>
        </a>
        <span>银行卡</span>
        <input type="hidden" id="user" value="{$user.id}">
    </header>
    <div class="mui-content1">
        <div class="main-form1" id="none">
            <form action="">
                <div class="form-group">
                    <input type="text" name="truename" id="name" placeholder="姓名" value="{$user.name}" >
                </div>
                 <div class="form-group">
                    <input type="text"  name="bankcard" id="bankcard" placeholder="银行卡帐号" value="{$user.bankcard}">
                </div>
                <div class="form-group">
                    <input type="text"  name="bank" id="bank" placeholder="银行名称" value="{$user.bank}">
                </div>
                 <div class="form-group">
                    <input type="text"  name="bankaddr" id="bankaddr" placeholder="开户支行" value="{$user.bankaddr}">
                </div>
                <div class="form-group">
                    <input type="password"  name="paypassword" id="paypassword" placeholder="交易密码">
                </div>

                <button type="button" onclick="Update()" class="confirm-btn">完成</button>
            </form>
        </div>
        <div class="main-form1" id="onlyread">
            <form action="">
                <div class="form-group">
                    姓名:{$user.name}
                </div>
                <div class="form-group">
                    银行卡号:{$user.bankcard}
                </div>
                <div class="form-group">
                    银行名称:{$user.bank}
                </div>
                <div class="form-group">
                    开户支行:{$user.bankaddr}
                </div>


                <button type="button" onclick="eidt()" class="confirm-btn">修改</button>
            </form>
        </div>
    </div>
</body>
<script>

    if($("#user").val()){
        $("#onlyread").show();
        $("#none").hide();
    }else{
        $("#onlyread").hide();
        $("#none").show();
    }

    function eidt() {
        $("#onlyread").hide();
        $("#none").show();
    }


    function Update(){
        var id=$('#user').val();

        var name=$('#name').val();

        var bank=$('#bank').val();

        var bankaddr=$('#bankaddr').val();

        var bankcard=$('#bankcard').val();

        var paypassword=$('#paypassword').val();

        if(name==""||name==null){

            layer.tips('请输入备注名称','#name',{tips:3});

            return false;

        }

        if(bankaddr==""||bankaddr==null){

            layer.tips('请输入开户支行','#bankaddr',{tips:3});

            return false;

        }

        if(bankcard==""||bankcard==null){

            layer.tips('请输入支付宝账号','#bankcard',{tips:3});

            return false;

        }

        if(paypassword==""||paypassword==null){

            layer.tips('请输入交易密码','#paypassword',{tips:3});

            return false;

        }





        $.post("{:U('User/upbank')}",{type:'bank',id:id,name:name,bank:bank,bankaddr:bankaddr,bankcard:bankcard,paypassword:paypassword},function(data){

            if(data.status==1){

                layer.msg(data.info,{icon:1});

                window.location="{:U('User/bank')}";

            }else{

                layer.msg(data.info,{icon:2});

                if(data.url){

                    window.location=data.url;

                }

            }

        },"json");

    }

</script>